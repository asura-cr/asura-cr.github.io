<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Fee Manager</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.9/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/framer-motion@10.12.16/dist/framer-motion.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    table { min-width: 100%; }
    @media (max-width: 640px) {
      table { font-size: 0.875rem; }
      th, td { padding: 0.5rem; }
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const { motion } = window.FramerMotion;

    const App = () => {
      const [isLoggedIn, setIsLoggedIn] = useState(localStorage.getItem('isLoggedIn') === 'true');
      const [username, setUsername] = useState('');
      const [password, setPassword] = useState('');
      const [students, setStudents] = useState([]);
      const [name, setName] = useState('');
      const [batch1, setBatch1] = useState('');
      const [batch2, setBatch2] = useState('');
      const [amount, setAmount] = useState('');
      const [paid, setPaid] = useState(false);
      const [editId, setEditId] = useState(null);
      const [filterBatch, setFilterBatch] = useState('');
      const [filterPaid, setFilterPaid] = useState('');

      // Load students from localStorage
      useEffect(() => {
        const savedStudents = localStorage.getItem('students');
        if (savedStudents) {
          setStudents(JSON.parse(savedStudents));
        }
      }, []);

      // Save students to localStorage
      useEffect(() => {
        localStorage.setItem('students', JSON.stringify(students));
      }, [students]);

      // Login handler
      const handleLogin = (e) => {
        e.preventDefault();
        if (username === 'admin' && password === 'password123') {
          setIsLoggedIn(true);
          localStorage.setItem('isLoggedIn', 'true');
        } else {
          alert('Invalid credentials');
        }
      };

      // Logout handler
      const handleLogout = () => {
        setIsLoggedIn(false);
        localStorage.setItem('isLoggedIn', 'false');
      };

      // Add or update student
      const handleSubmit = (e) => {
        e.preventDefault();
        if (!name || !batch1 || !batch2 || !amount) {
          alert('Please fill all fields');
          return;
        }
        if (batch1 === batch2) {
          alert('Batches must be different');
          return;
        }
        const newStudent = {
          id: editId || Date.now(),
          name,
          batch: `${batch1} & ${batch2}`,
          amount: parseFloat(amount),
          paid,
        };
        if (editId) {
          setStudents(students.map(s => s.id === editId ? newStudent : s));
          setEditId(null);
        } else {
          setStudents([...students, newStudent]);
        }
        resetForm();
      };

      // Reset form
      const resetForm = () => {
        setName('');
        setBatch1('');
        setBatch2('');
        setAmount('');
        setPaid(false);
        setEditId(null);
      };

      // Edit student
      const handleEdit = (student) => {
        setEditId(student.id);
        setName(student.name);
        const [b1, b2] = student.batch.split(' & ');
        setBatch1(b1);
        setBatch2(b2);
        setAmount(student.amount);
        setPaid(student.paid);
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };

      // Delete student
      const handleDelete = (id) => {
        if (window.confirm('Are you sure you want to delete this student?')) {
          setStudents(students.filter(s => s.id !== id));
        }
      };

      // Toggle payment status
      const togglePaid = (id) => {
        setStudents(students.map(s =>
          s.id === id ? { ...s, paid: !s.paid } : s
        ));
      };

      // Filter students
      const filteredStudents = students.filter(s => {
        const batchMatch = filterBatch ? s.batch.includes(filterBatch) : true;
        const paidMatch = filterPaid ? s.paid === (filterPaid === 'paid') : true;
        return batchMatch && paidMatch;
      });

      if (!isLoggedIn) {
        return (
          <div className="flex items-center justify-center min-h-screen">
            <motion.div
              initial={{ opacity: 0, y: -50 }}
              animate={{ opacity: 1, y: 0 }}
              className="bg-white p-8 rounded-lg shadow-lg w-full max-w-md"
            >
              <h2 className="text-2xl font-bold mb-6 text-center">Login</h2>
              <form onSubmit={handleLogin}>
                <input
                  type="text"
                  placeholder="Username"
                  value={username}
                  onChange={(e) => setUsername(e.target.value)}
                  className="w-full p-3 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <input
                  type="password"
                  placeholder="Password"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="w-full p-3 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <motion.button
                  whileHover={{ scale: 1.05 }}
                  whileTap={{ scale: 0.95 }}
                  type="submit"
                  className="w-full bg-blue-500 text-white p-3 rounded hover:bg-blue-600"
                >
                  Login
                </motion.button>
              </form>
            </motion.div>
          </div>
        );
      }

      return (
        <div className="container mx-auto p-4 min-h-screen">
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            className="flex justify-between items-center mb-6"
          >
            <h1 className="text-3xl font-bold">Student Fee Manager</h1>
            <motion.button
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
              onClick={handleLogout}
              className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
            >
              Logout
            </motion.button>
          </motion.div>

          {/* Add/Edit Student Form */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="bg-white p-6 rounded-lg shadow-lg mb-6"
          >
            <h2 className="text-xl font-semibold mb-4">{editId ? 'Edit Student' : 'Add Student'}</h2>
            <form onSubmit={handleSubmit}>
              <input
                type="text"
                placeholder="Student Name"
                value={name}
                onChange={(e) => setName(e.target.value)}
                className="w-full p-3 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <select
                value={batch1}
                onChange={(e) => setBatch1(e.target.value)}
                className="w-full p-3 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <option value="">Select First Batch</option>
                <option value="Thursday">Thursday</option>
                <option value="Saturday Morning">Saturday Morning</option>
                <option value="Saturday Evening">Saturday Evening</option>
                <option value="Sunday Morning">Sunday Morning</option>
              </select>
              <select
                value={batch2}
                onChange={(e) => setBatch2(e.target.value)}
                className="w-full p-3 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <option value="">Select Second Batch</option>
                <option value="Thursday">Thursday</option>
                <option value="Saturday Morning">Saturday Morning</option>
                <option value="Saturday Evening">Saturday Evening</option>
                <option value="Sunday Morning">Sunday Morning</option>
              </select>
              <input
                type="number"
                placeholder="Amount (AED)"
                value={amount}
                onChange={(e) => setAmount(e.target.value)}
                className="w-full p-3 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                min="0"
                step="0.01"
              />
              <label className="flex items-center mb-4">
                <input
                  type="checkbox"
                  checked={paid}
                  onChange={(e) => setPaid(e.target.checked)}
                  className="mr-2 h-5 w-5"
                />
                <span>Paid this month</span>
              </label>
              <div className="flex space-x-2">
                <motion.button
                  whileHover={{ scale: 1.05 }}
                  whileTap={{ scale: 0.95 }}
                  type="submit"
                  className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
                >
                  {editId ? 'Update' : 'Add'}
                </motion.button>
                {editId && (
                  <motion.button
                    whileHover={{ scale: 1.05 }}
                    whileTap={{ scale: 0.95 }}
                    type="button"
                    onClick={resetForm}
                    className="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"
                  >
                    Cancel
                  </motion.button>
                )}
              </div>
            </form>
          </motion.div>

          {/* Filters */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="bg-white p-6 rounded-lg shadow-lg mb-6"
          >
            <h2 className="text-xl font-semibold mb-4">Filters</h2>
            <div className="flex space-x-4 flex-col sm:flex-row">
              <select
                value={filterBatch}
                onChange={(e) => setFilterBatch(e.target.value)}
                className="p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 mb-2 sm:mb-0"
              >
                <option value="">All Batches</option>
                <option value="Thursday">Thursday</option>
                <option value="Saturday Morning">Saturday Morning</option>
                <option value="Saturday Evening">Saturday Evening</option>
                <option value="Sunday Morning">Sunday Morning</option>
              </select>
              <select
                value={filterPaid}
                onChange={(e) => setFilterPaid(e.target.value)}
                className="p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <option value="">All Payment Status</option>
                <option value="paid">Paid</option>
                <option value="unpaid">Unpaid</option>
              </select>
            </div>
          </motion.div>

          {/* Student List */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="bg-white p-6 rounded-lg shadow-lg"
          >
            <h2 className="text-xl font-semibold mb-4">Students</h2>
            {filteredStudents.length === 0 ? (
              <p className="text-gray-500">No students found.</p>
            ) : (
              <div className="overflow-x-auto">
                <table className="w-full border-collapse">
                  <thead>
                    <tr className="bg-gray-200">
                      <th className="border p-3 text-left">Name</th>
                      <th className="border p-3 text-left">Batch</th>
                      <th className="border p-3 text-left">Amount (AED)</th>
                      <th className="border p-3 text-left">Paid</th>
                      <th className="border p-3 text-left">Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {filteredStudents.map(student => (
                      <motion.tr
                        key={student.id}
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        className="hover:bg-gray-50"
                      >
                        <td className="border p-3">{student.name}</td>
                        <td className="border p-3">{student.batch}</td>
                        <td className="border p-3">{student.amount.toFixed(2)}</td>
                        <td className="border p-3">
                          <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={() => togglePaid(student.id)}
                            className={`px-3 py-1 rounded ${
                              student.paid ? 'bg-green-500' : 'bg-red-500'
                            } text-white`}
                          >
                            {student.paid ? 'Paid' : 'Unpaid'}
                          </motion.button>
                        </td>
                        <td className="border p-3">
                          <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={() => handleEdit(student)}
                            className="bg-yellow-500 text-white px-3 py-1 rounded mr-2 hover:bg-yellow-600"
                          >
                            Edit
                          </motion.button>
                          <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={() => handleDelete(student.id)}
                            className="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600"
                          >
                            Delete
                          </motion.button>
                        </td>
                      </motion.tr>
                    ))}
                  </tbody>
                </table>
              </div>
            )}
          </motion.div>
        </div>
      );
    };

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
